% 情報学科卒論表紙作成マクロ  Ver. 1.1                 1998.2.13
%
% このファイルには、情報学科の卒論の表紙を作成するための LaTeX の
% マクロ \makecoverpage が定義されています。以下のサンプルを参考に
% して利用して下さい。
%
%  \documentstyle[a4j]{jarticle}
%
%  \input cover.mac
%
%  % 卒研の題目が長い場合には、\\ を挿入し、行を分割することができます。
%  \卒研題目={立命館大学における \\ 情報工学に \\ 関する研究}
%  %\卒研題目={立命館大学における \\ 情報工学に関する研究}
%  %\卒研題目={情報工学に関する研究}
%  %\卒研題目={大学における情報工学に関する研究}
%
%  \氏名={草津 花子}
%  \学籍番号={2210940000-0}
%  \指導教員={立命 太郎}
%  \提出日={1998年2月20日}
%
%  % 共同研究者がいる時には次の行のコメントをはずす。
%  %\共同研究者あり
%  \共同研究者={情報 二郎 ・ 情報 三郎 ・ \\ 情報 史郎 ・ \\ 情報 五郎}
%
%  \begin{document}
%
%  \makecoverpage
%
%  \end{document}
%

\newtoks\学期
\newtoks\年度
\newtoks\クラス
\newtoks\卒研題目
\newtoks\氏名
\newtoks\回生
\newtoks\学籍番号
\newtoks\指導教員
\newtoks\提出日
\newtoks\共同研究者
\newtoks\共同研究者なし

\newif\if共同研究者あり \共同研究者ありfalse
\def\共同研究者あり{\共同研究者ありtrue}

\newdimen\X卒業論文
\newdimen\Y卒業論文
\newdimen\X題目
\newdimen\Y題目
\newdimen\X氏名
\newdimen\Y氏名
\newdimen\X共同研究者
\newdimen\Y共同研究者
\newdimen\X情報学科
\newdimen\Y情報学科
\newdimen\X情シス
\newdimen\Y情シス
\newdimen\Xoffset
\newdimen\Yoffset

\newdimen\X年度
\newdimen\Y年度


\newbox\dummybox
\newbox\titlebox
\makeatletter
\newcommand{\fontHuge}[0]{\@setfontsize\fontHuge\@xxvpt{33}}
\newcommand{\fontLARGE}[0]{\@setfontsize\fontHuge\@xviipt{25}}
\makeatother

\thispagestyle{empty}

\newcommand{\makecoverpage}[0]{
  \X卒業論文=65mm   \Y卒業論文=30mm
  \X題目=17mm       \Y題目=84mm
  \X氏名=51mm       \Y氏名=151mm
  \X共同研究者=51mm \Y共同研究者=193mm
%  \X情報学科=46.5mm \Y情報学科=224.5mm
  \X情シス=28mm     \Y情シス=224mm
  \X年度=5mm	\Y年度=0mm

% a4j のスタイルでは、\oddsidemargin=0in, \topmaigin=-0.3in で、
% \Xoffset=\Yoffset=0mm で良い。
% a4j スタイルとは異なるマージンにも対応するために、
  \Xoffset=0in    \advance\Xoffset by -\oddsidemargin
  \Yoffset=-0.3in \advance\Yoffset by -\topmargin

  \advance\X卒業論文 by \Xoffset
  \advance\Y卒業論文 by \Yoffset
  \advance\X題目 by \Xoffset
  \advance\Y題目 by \Yoffset
  \advance\X氏名 by \Xoffset
  \advance\Y氏名 by \Yoffset
  \advance\X共同研究者 by \Xoffset
  \advance\Y共同研究者 by \Yoffset
  \advance\X情報学科 by \Xoffset
  \advance\Y情報学科 by \Yoffset
  \advance\X情シス by \Xoffset
  \advance\Y情シス by \Yoffset
  
  \XY{\X年度}{\Y年度}{
  \begin{minipage}{100mm}
  {\large
  \the\年度 年度（\the\学期 学期）\\
  卒業研究3（\the\クラス ）}
  \end{minipage}
  }

  \XY{\X卒業論文}{\Y卒業論文}{\fontHuge \CoverKintou{6zw}{卒業論文}}

  \XY{\X題目}{\Y題目}{
    \setbox\titlebox=\vbox{
      \begin{minipage}{140mm}\begin{centering}
      \fontHuge\bf \the\卒研題目 \par
      \end{centering}\end{minipage}}
    \vspace*{-\ht\titlebox}
    \box\titlebox%\nointerlineskip
  }
%
  \XY{\X氏名}{\Y氏名}{
  \begin{minipage}{115mm}
  \fontLARGE \begin{list}{}{
  \leftmargin=6zw \labelwidth=6zw \labelsep=5mm \itemsep=-1mm \parsep=4pt}
  \item[\CoverKintou{5zw}{氏名}：]     \the\氏名
  \item[\CoverKintou{5zw}{回生}：]     \the\回生
  \item[\CoverKintou{5zw}{学生証番号}：] \the\学籍番号
  \item[\CoverKintou{5zw}{指導教員}：] \the\指導教員
  \item[\CoverKintou{5zw}{提出日}：]   \the\提出日
  \end{list}
  \end{minipage}}

  \if共同研究者あり
  \XY{\X共同研究者}{\Y共同研究者}{
  \begin{minipage}{115mm}
  \fontLARGE \begin{list}{}{
  \leftmargin=6zw \labelwidth=6zw \labelsep=5mm}
  \item[\CoverKintou{5zw}{共同研究者}：]  \the\共同研究者 \ 
  \end{list}
  \end{minipage}}
  \fi
  \XY{\X情シス}{\Y情シス}{\fontLARGE 立命館大学 情報理工学部 情報システム学科}
%
  \vspace{117.8mm} \hspace{-25mm} \rule{10mm}{0.1mm}
  \newpage
}

%magic way of pointing a place defined by X-Y coordinate
\newdimen\htbackskip
\newdimen\dpbackskip
\long\def\XY#1#2#3{
  \setbox\dummybox=\vbox{
    \vskip#2
    \hbox to \hsize{%
      \hskip#1
      \vbox{\advance\hsize by -#1#3}\hfil
    }
  }
  \htbackskip=-\ht\dummybox
  \dpbackskip=-\dp\dummybox
%
  \box\dummybox\nointerlineskip
  \vskip\htbackskip
  \vskip\dpbackskip
}

\newcommand{\CoverKintou}[2]{\hbox to#1{%
  \kanjiskip=0pt plus 1fill minus 1fill
  \xkanjiskip=\kanjiskip #2}
}
